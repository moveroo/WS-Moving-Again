---
/**
 * BrainAnalytics - Astro wrapper for Brain Web Analytics
 *
 * Usage:
 *   <BrainAnalytics />
 *
 * Requires environment variables:
 *   PUBLIC_BRAIN_URL - Brain API URL (e.g., https://again.com.au)
 *   PUBLIC_BRAIN_KEY - Brain API key
 */

const brainUrl = import.meta.env.PUBLIC_BRAIN_URL || import.meta.env.BRAIN_BASE_URL || '';
const brainKey = import.meta.env.PUBLIC_BRAIN_KEY || import.meta.env.BRAIN_API_KEY || '';
const debug = import.meta.env.DEV;
---

{
  brainUrl && brainKey && (
    <>
      <script is:inline src="/brain-analytics.js" defer />
      {/* prettier-ignore */}
      <script is:inline set:html={`
        window.addEventListener('DOMContentLoaded', function() {
          if (typeof BrainAnalytics !== 'undefined') {
            BrainAnalytics.init({
              url: '${brainUrl}',
              key: '${brainKey}',
              debug: ${debug},
              trackScrollDepth: true,
              trackPerformance: true,
              trackClicks: true
            });
          }
        });
      `} />
    </>
  )
}
