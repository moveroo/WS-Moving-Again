---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import SEO from '../components/SEO.astro';
import BrainAnalytics from '../components/BrainAnalytics.astro';
import Schema from '../components/Schema.astro';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  schemaType?: 'WebSite' | 'Organization' | 'Article' | 'Product' | 'FAQPage' | 'LocalBusiness';
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  schemaData?: Record<string, any>;
}

const { title, description, image, schemaType = 'WebSite', schemaData = {} } = Astro.props;
---

<SEO title={title} description={description} image={image}>
  <!-- Brain Analytics (First-Party) -->
  <BrainAnalytics slot="head" />

  <!-- Global Schema -->
  <Schema type={schemaType} data={schemaData} slot="head" />

  <!-- Organization Schema (Global - for brand visibility) -->
  <Schema
    type="Organization"
    data={{
      name: 'Moving Again',
      url: 'https://movingagain.com.au',
      logo: 'https://movingagain.com.au/logo.svg',
      description:
        "Australia's trusted interstate removalists and backloading specialists since 2010",
      telephone: '+61 7 2143 2557',
      email: 'info@movingagain.com.au',
      address: {
        '@type': 'PostalAddress',
        streetAddress: '3/31 Expansion Street',
        addressLocality: 'Molendinar',
        addressRegion: 'QLD',
        postalCode: '4216',
        addressCountry: 'AU',
      },
      sameAs: ['https://www.facebook.com/MovingAgain'],
    }}
    slot="head"
  />

  <!-- Preload Fonts to Avoid Chaining -->
  <link
    rel="preload"
    href="/fonts/roboto-regular.woff2"
    as="font"
    type="font/woff2"
    crossorigin
    slot="head"
  />
  <link
    rel="preload"
    href="/fonts/roboto-bold.woff2"
    as="font"
    type="font/woff2"
    crossorigin
    slot="head"
  />

  <style is:global>
    @font-face {
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src: url('/fonts/roboto-regular.woff2') format('woff2');
    }
    @font-face {
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url('/fonts/roboto-bold.woff2') format('woff2');
    }
  </style>

  <!-- App Structure -->
  <div class="flex flex-col min-h-screen bg-brand-light font-sans text-brand-dark">
    <Header />

    <main class="flex-grow">
      <slot />
    </main>

    <Footer />
  </div>
</SEO>
