---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import SEO from '../components/SEO.astro';
import BrainAnalytics from '../components/BrainAnalytics.astro';
import Schema from '../components/Schema.astro';
import { BRAND } from '../utils/brand';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  schemaType?: 'WebSite' | 'Organization' | 'Article' | 'Product' | 'FAQPage' | 'LocalBusiness';
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  schemaData?: Record<string, any>;
  modifiedDate?: string; // Pass through to SEO component
}

const {
  title,
  description,
  image,
  schemaType = 'WebSite',
  schemaData = {},
  modifiedDate,
} = Astro.props;
---

<SEO title={title} description={description} image={image} modifiedDate={modifiedDate}>
  <!-- Brain Analytics (First-Party) -->
  <BrainAnalytics slot="head" />

  <!-- Global Schema -->
  <Schema type={schemaType} data={schemaData} slot="head" />

  <!-- Organization Schema (Global - for brand visibility) -->
  <Schema
    type="Organization"
    data={{
      name: BRAND.name,
      url: BRAND.website,
      logo: {
        '@type': 'ImageObject',
        url: `${BRAND.website}/logo.svg`,
        width: 200,
        height: 50,
      },
      description: `Australia's trusted interstate removalists and backloading specialists. Save up to 60% on interstate moves with professional backloading services across all major Australian cities. ${BRAND.yearsInBusiness} years of experience.`,
      telephone: '+61 7 2143 2557',
      email: BRAND.email,
      foundingDate: BRAND.foundingYear.toString(),
      address: {
        '@type': 'PostalAddress',
        streetAddress: '3/31 Expansion Street',
        addressLocality: 'Molendinar',
        addressRegion: 'QLD',
        postalCode: '4216',
        addressCountry: 'AU',
      },
      areaServed: {
        '@type': 'Country',
        name: 'Australia',
      },
      serviceArea: {
        '@type': 'Country',
        name: 'Australia',
      },
      contactPoint: {
        '@type': 'ContactPoint',
        telephone: '+61 7 2143 2557',
        contactType: 'Customer Service',
        email: 'info@movingagain.com.au',
        areaServed: 'AU',
        availableLanguage: 'English',
      },
      sameAs: ['https://www.facebook.com/MovingAgain'],
      '@id': 'https://movingagain.com.au/#organization',
    }}
    slot="head"
  />

  <!-- Preload Fonts to Avoid Chaining -->
  <link
    rel="preload"
    href="/fonts/roboto-regular.woff2"
    as="font"
    type="font/woff2"
    crossorigin
    slot="head"
  />
  <link
    rel="preload"
    href="/fonts/roboto-bold.woff2"
    as="font"
    type="font/woff2"
    crossorigin
    slot="head"
  />

  <style is:global>
    @font-face {
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src: url('/fonts/roboto-regular.woff2') format('woff2');
    }
    @font-face {
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src: url('/fonts/roboto-bold.woff2') format('woff2');
    }
  </style>

  <!-- App Structure -->
  <div class="flex flex-col min-h-screen bg-brand-light font-sans text-brand-dark">
    <!-- Skip Navigation Link -->
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-brand-red focus:text-white focus:font-bold focus:rounded-brand focus:shadow-lg"
    >
      Skip to content
    </a>
    <Header />

    <main id="main-content" class="flex-grow" role="main">
      <slot />
    </main>

    <Footer />
  </div>
</SEO>
